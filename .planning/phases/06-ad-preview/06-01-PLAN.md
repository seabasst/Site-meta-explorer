---
phase: 06-ad-preview
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ads/ad-preview-card.tsx
autonomous: true

must_haves:
  truths:
    - "AdPreviewCard component renders ad creative text"
    - "AdPreviewCard shows media type badge for video/image ads"
    - "AdPreviewCard is a clickable link to Facebook Ad Library"
    - "Card has hover effect indicating interactivity"
  artifacts:
    - path: "src/components/ads/ad-preview-card.tsx"
      provides: "Reusable ad preview card component"
      exports: ["AdPreviewCard"]
      min_lines: 40
  key_links:
    - from: "src/components/ads/ad-preview-card.tsx"
      to: "lucide-react"
      via: "icon imports"
      pattern: "import.*from 'lucide-react'"
---

<objective>
Create a reusable AdPreviewCard component that displays ad creative text, shows media type badges, and links to Facebook Ad Library.

Purpose: This component is the core UI element for Phase 6, enabling users to view ad details and access Facebook (PREV-01, PREV-02, PREV-03).

Output: `src/components/ads/ad-preview-card.tsx` - standalone component ready for integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-ad-preview/06-CONTEXT.md
@.planning/phases/06-ad-preview/06-RESEARCH.md

Key references:
- Existing clickable card pattern: src/components/analytics/ad-longevity.tsx (lines 146-172)
- FacebookAdResult type: src/lib/facebook-api.ts (lines 79-101)
- Media type colors: purple (#8b5cf6) for video, blue (#3b82f6) for image
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ads directory and AdPreviewCard component</name>
  <files>src/components/ads/ad-preview-card.tsx</files>
  <action>
Create the ads component directory and AdPreviewCard component:

1. Create directory: `src/components/ads/`

2. Create `ad-preview-card.tsx` with:

**Interface:**
```typescript
interface AdPreviewCardProps {
  ad: {
    adArchiveId: string;
    creativeBody: string | null;
    linkTitle: string | null;
    mediaType: 'video' | 'image' | 'unknown';
    euTotalReach: number;
    startedRunning: string | null;
  };
}
```

**Component structure:**
- Outer `<a>` tag linking to `https://www.facebook.com/ads/library/?id=${ad.adArchiveId}`
- Use `target="_blank"` and `rel="noopener noreferrer"`
- Apply `group` class for coordinated hover effects

**Media type badge (top-right corner):**
- Import `Play`, `Image as ImageIcon`, `ExternalLink` from `lucide-react`
- Show `Play` icon (purple-500) for video
- Show `ImageIcon` icon (blue-500) for image
- Show nothing for `'unknown'` type
- Badge styling: `absolute top-2 right-2 p-1.5 rounded-md bg-[var(--bg-elevated)] border border-[var(--border-subtle)]`

**Card content:**
- Display `ad.linkTitle` if available, else `ad.creativeBody`, else fallback "View Ad"
- Show full creative text (no truncation per user decision)
- Display EU reach badge
- Show "Started: {date}" if available

**Hover effects:**
- Card: `hover:border-[var(--accent-green)] transition-colors`
- Text: `group-hover:text-[var(--accent-green-light)]`
- External link icon: Small ExternalLink icon, `opacity-60 group-hover:opacity-100`

**Styling:**
- Card: `relative flex flex-col p-4 rounded-lg bg-[var(--bg-tertiary)] border border-[var(--border-subtle)] cursor-pointer`
- Use CSS variables from existing codebase
  </action>
  <verify>
File exists: `ls src/components/ads/ad-preview-card.tsx`
No TypeScript errors: `npx tsc --noEmit`
  </verify>
  <done>
AdPreviewCard component created with:
- Clickable card linking to Facebook Ad Library
- Media type badge (Play/Image icons) in top-right
- Full creative text display
- Hover effects on card and text
- External link icon indicator
  </done>
</task>

<task type="auto">
  <name>Task 2: Add fallback handling and edge cases</name>
  <files>src/components/ads/ad-preview-card.tsx</files>
  <action>
Enhance AdPreviewCard with proper edge case handling:

1. **Fallback display text logic:**
```typescript
const displayTitle = ad.linkTitle || ad.creativeBody || 'View Ad';
const displayBody = ad.creativeBody && ad.linkTitle ? ad.creativeBody : null;
```

2. **Empty state for no title/body:**
- If both null, show "View Ad #{ad.adArchiveId.slice(-6)}" as title
- Style fallback text with muted color

3. **Date formatting:**
- Format startedRunning date nicely: `new Date(ad.startedRunning).toLocaleDateString()`
- Show "Unknown start date" if null

4. **Reach formatting:**
- Format with `toLocaleString()` for thousands separator
- Show reach badge with accent-yellow background

5. **Add JSDoc comment at top:**
```typescript
/**
 * AdPreviewCard - Displays ad creative with link to Facebook Ad Library
 *
 * Features:
 * - Clickable card opens Facebook Ad Library in new tab
 * - Media type badge (video/image) in top-right corner
 * - Full creative text display (no truncation)
 * - Hover effects for interactivity feedback
 */
```
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Component exports correctly: `grep -n "export.*AdPreviewCard" src/components/ads/ad-preview-card.tsx`
  </verify>
  <done>
AdPreviewCard handles edge cases:
- Null creativeBody/linkTitle with fallback text
- Unknown media type (no badge)
- Missing start date
- Proper number formatting for reach
  </done>
</task>

</tasks>

<verification>
Component verification:
- [ ] File exists at `src/components/ads/ad-preview-card.tsx`
- [ ] Exports `AdPreviewCard` component
- [ ] Imports lucide-react icons (Play, Image, ExternalLink)
- [ ] Uses FacebookAdResult-compatible props
- [ ] No TypeScript errors

Pattern verification:
- [ ] Uses `<a>` tag with proper external link attributes
- [ ] Uses CSS variables (var(--...)) for colors
- [ ] Uses group hover pattern
- [ ] Uses Tailwind classes matching existing patterns
</verification>

<success_criteria>
- AdPreviewCard component is a self-contained, reusable component
- Component accepts ad data matching FacebookAdResult structure
- Media type badge shows for video/image, hidden for unknown
- Full creative text displays without truncation
- Card is clickable and opens Facebook in new tab
- Hover states provide clear interactivity feedback
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-ad-preview/06-01-SUMMARY.md`
</output>
