---
phase: 06-ad-preview
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/app/page.tsx
autonomous: false

must_haves:
  truths:
    - "User can click any ad card to view it on Facebook"
    - "User can see ad creative text in the results"
    - "User can distinguish video ads from image ads via badge"
  artifacts:
    - path: "src/app/page.tsx"
      provides: "Integrated ad preview cards in results"
      contains: "AdPreviewCard"
  key_links:
    - from: "src/app/page.tsx"
      to: "src/components/ads/ad-preview-card.tsx"
      via: "component import"
      pattern: "import.*AdPreviewCard.*from"
---

<objective>
Integrate AdPreviewCard component into page.tsx, replacing the existing ad display with the new preview cards.

Purpose: Complete Phase 6 by showing ad preview cards to users, fulfilling PREV-01, PREV-02, PREV-03.

Output: Updated `src/app/page.tsx` with AdPreviewCard integration in the results section.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-ad-preview/06-CONTEXT.md
@.planning/phases/06-ad-preview/06-01-SUMMARY.md

Key references:
- Main page: src/app/page.tsx
- AdPreviewCard: src/components/ads/ad-preview-card.tsx (created in 06-01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Import AdPreviewCard and add to results section</name>
  <files>src/app/page.tsx</files>
  <action>
Integrate AdPreviewCard into the main page:

1. **Add import at top of file:**
```typescript
import { AdPreviewCard } from '@/components/ads/ad-preview-card';
```

2. **Locate "Top performing ads by reach" section** (around line 716-733)

3. **Replace the existing inline ad links with AdPreviewCard grid:**

Replace this section:
```tsx
<div className="flex flex-wrap gap-2">
  {apiResult.ads.slice(0, 5).map((ad, index) => (
    <a key={index} href={...} ...>
      ...
    </a>
  ))}
</div>
```

With:
```tsx
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-3">
  {apiResult.ads.slice(0, 6).map((ad, index) => (
    <AdPreviewCard key={ad.adArchiveId || index} ad={ad} />
  ))}
</div>
{apiResult.ads.length > 6 && (
  <p className="text-center text-xs text-[var(--text-muted)] mt-4">
    +{apiResult.ads.length - 6} more ads (expand "View all" below)
  </p>
)}
```

4. **Update section header text:**
Change "Top performing ads by reach:" to "Top Ads" (shorter, cleaner)
  </action>
  <verify>
Import added: `grep -n "AdPreviewCard" src/app/page.tsx | head -5`
TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
AdPreviewCard integrated into results section:
- Import added
- Grid layout with 6 preview cards
- Responsive columns (1/2/3)
- "+X more ads" indicator
  </done>
</task>

<task type="auto">
  <name>Task 2: Update expanded ads table with media type column</name>
  <files>src/app/page.tsx</files>
  <action>
Enhance the "View all X ads" expandable table with media type indicators:

1. **Locate the expandable table section** (around line 743-806)

2. **Add media type column header:**
After the "Ad Content" th, add:
```tsx
<th className="px-4 py-2 text-center text-xs font-medium text-[var(--text-muted)] uppercase tracking-wide w-16">Type</th>
```

3. **Add media type cell in table body:**
After the ad content td, add:
```tsx
<td className="px-4 py-3 text-center">
  {ad.mediaType === 'video' && (
    <span className="inline-flex items-center gap-1 text-purple-500" title="Video">
      <Play className="w-4 h-4" />
    </span>
  )}
  {ad.mediaType === 'image' && (
    <span className="inline-flex items-center gap-1 text-blue-500" title="Image">
      <ImageIcon className="w-4 h-4" />
    </span>
  )}
  {ad.mediaType === 'unknown' && (
    <span className="text-[var(--text-muted)]">-</span>
  )}
</td>
```

4. **Add icon imports at top if not already present:**
```typescript
import { Play, Image as ImageIcon } from 'lucide-react';
```
  </action>
  <verify>
Table has media type column: `grep -n "mediaType" src/app/page.tsx | wc -l` (should be > 0)
TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
Expanded table enhanced:
- Media type column added
- Video shows purple Play icon
- Image shows blue Image icon
- Unknown shows dash
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Ad preview cards with clickable links to Facebook, creative text display, and media type indicators.
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Open http://localhost:3000
3. Enter an Ad Library URL and click "Analyse Ads"
4. Verify in results section:
   - [ ] Ad preview cards appear in a grid layout
   - [ ] Cards show ad creative text (full text, no truncation)
   - [ ] Video ads have purple Play icon badge in top-right
   - [ ] Image ads have blue Image icon badge in top-right
   - [ ] Unknown type ads have no badge
   - [ ] Clicking a card opens Facebook Ad Library in new tab
   - [ ] Cards have hover effect (border color change)
   - [ ] External link icon visible on cards
5. Expand "View all X ads" section:
   - [ ] Table shows media type column with icons
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe issues found</resume-signal>
</task>

</tasks>

<verification>
Integration verification:
- [ ] AdPreviewCard imported in page.tsx
- [ ] Cards render in grid layout
- [ ] Clicking card opens Facebook Ad Library
- [ ] Media type badges display correctly
- [ ] Hover effects work
- [ ] Expanded table shows media type column

Requirement verification:
- [ ] PREV-01: User can click to view ad on Facebook (opens in new tab)
- [ ] PREV-02: User can see ad creative text in results
- [ ] PREV-03: User can distinguish video from image ads
</verification>

<success_criteria>
- AdPreviewCard displays in results grid
- Clicking any card opens Facebook Ad Library in new tab
- Creative text is fully visible (no truncation)
- Media type badges show for video/image ads
- Expanded table includes media type column
- All Phase 6 requirements (PREV-01, PREV-02, PREV-03) satisfied
- User verifies functionality works as expected
</success_criteria>

<output>
After completion, create `.planning/phases/06-ad-preview/06-02-SUMMARY.md`
</output>
