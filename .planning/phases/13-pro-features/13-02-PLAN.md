---
phase: 13-pro-features
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/demographics/age-gender-chart.tsx
  - src/components/demographics/country-chart.tsx
autonomous: true

must_haves:
  truths:
    - "Charts display enhanced tooltips on hover with rich context"
    - "Age/gender chart shows combined total and individual gender values"
    - "Country chart shows percentage and formatted reach numbers"
    - "Tooltips are styled consistently with dark theme"
  artifacts:
    - path: "src/components/demographics/age-gender-chart.tsx"
      provides: "Enhanced age/gender chart with better hover states"
      contains: "EnhancedTooltip"
    - path: "src/components/demographics/country-chart.tsx"
      provides: "Enhanced country chart with rich tooltips"
      contains: "EnhancedTooltip"
  key_links:
    - from: "src/components/demographics/age-gender-chart.tsx"
      to: "chart data"
      via: "tooltip content rendering"
      pattern: "group-hover"
---

<objective>
Enhance existing charts with better tooltips and labels for improved data readability.

Purpose: Implements TIER-04 (Pro users get enhanced charts with better labels).
Output: Improved tooltips and hover states on age/gender and country charts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-pro-features/13-RESEARCH.md

@src/components/demographics/age-gender-chart.tsx
@src/components/demographics/country-chart.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance age/gender chart tooltips</name>
  <files>src/components/demographics/age-gender-chart.tsx</files>
  <action>
Improve the age/gender chart with enhanced tooltip information.

Current behavior: Shows "X% total" on hover for each age group row.

Enhanced behavior:
1. Improve the hover tooltip to show more context:
   - Current: just shows combined percentage
   - Enhanced: Show breakdown like "Male: X% | Female: Y% | Total: Z%"

2. Add better visual feedback on hover:
   - Current bars have `group-hover:brightness-110`
   - Add subtle scale transform: `group-hover:scale-[1.02]` on the bar container

3. Add value labels that appear on hover:
   - When percentage is small (< 3%), show value outside bar on hover
   - Use a floating tooltip-style element that appears on hover

4. Improve the summary insight section:
   - Add a "dominant segment" callout below the chart
   - Show which age-gender combo has highest percentage

Implementation notes:
- Keep existing CSS variable usage (var(--text-primary), etc)
- Keep existing animation classes
- Use group/hover pattern already in component
- No new dependencies needed - pure CSS/React enhancements
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Chart renders correctly: `npm run dev` and visually inspect
  </verify>
  <done>
Age/gender chart displays enhanced tooltips with gender breakdown on hover.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance country chart tooltips</name>
  <files>src/components/demographics/country-chart.tsx</files>
  <action>
First read the current country-chart.tsx implementation, then enhance it with better tooltips.

Add enhanced tooltips that show:
1. Country name (full name, not just code)
2. Percentage with one decimal
3. Relative position (e.g., "#2 of 15 countries")

Add visual enhancements:
1. Hover state that highlights the bar more prominently
2. Smooth transition on hover
3. Value label that's always visible for top 3 countries

Implementation approach:
- Use group/hover pattern for hover states
- Add tooltip-style div that appears on hover
- Keep existing bar chart structure
- Use CSS variables for consistent theming

Country code to name mapping (if not already present):
- Use a simple lookup object for common EU countries
- Fallback to showing code if name not found
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Chart renders correctly: `npm run dev` and visually inspect
  </verify>
  <done>
Country chart displays enhanced tooltips with country names and ranking on hover.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. Age/gender chart shows enhanced hover states with full breakdown
3. Country chart shows country names and rankings on hover
4. Both charts maintain existing functionality
5. Styling consistent with dark theme using CSS variables
</verification>

<success_criteria>
- Charts provide richer context on hover
- Tooltips are styled consistently with app theme
- No visual regressions in chart appearance
- Enhanced charts work with existing data structure
</success_criteria>

<output>
After completion, create `.planning/phases/13-pro-features/13-02-SUMMARY.md`
</output>
